/# boat_pro
无人船作业安全预测系统
一、无人船作业安全预测系统需求：
1.无人船驶出船坞时碰撞预测
2.无人船驶入船坞时碰撞预测
2.无人船按规划航线运行时前后船碰撞预测
3.无人船对向航行时的碰撞安全预测。
 
二.	优先级说明
1.出坞碰撞检测：优先级最低，需要等待入船坞的船，以及正常行驶的被碰撞船驶出危险位置后，才能出坞。
2.入坞碰撞检测：优先级最高，在某个船开始入坞转向时，跟随其后的船需要等待入坞完成后，才能继续通行。
3.优先级等级：驶入船坞 ＞ 正常航行 ＞ 驶出船坞
 
三、应用场景及功能性需求
（一）、应用场景
无人船长度为75CM，宽度 47CM（项目暂定以该尺寸的无人船为标准开发）
船的数量≤30条。
固定航线巡航。最多 2 条航线，一条顺时针，一条逆时针，2 条航线最小横向距离大于 10 米。
水域类似静水状态、流速低。
（二）、功能性需求
1.	无人船的尺寸等参数做成配置参数，可修改，以便适配不同的船只。
2.	进船坞定义：当船完成作业，到达集结点（终点/起始点）后，船进入待进坞状态，船转入进坞模式，无人船集群管理系统接收到船待进坞信息，判断船能否进坞，进几号船坞，并将信息发送给待进坞船只。当船只驶入船坞，并且速度为0时，船进入锁定状态，进坞程序结束。
3.	出船坞定义：用户提出出坞请求，由当前船控向无人船集群管理系统发出请示，系统收到后发送解锁命令到船坞，船坞反馈已解锁后，系统再发送出坞指令给船，船收到命令后自动航行到集结点（起始点/终点）；船到达集结点后（悬停状态），向服务器询问是否进入航线执行相应航线。
 
四.	拟输出的数据：
1. 系统及时给出碰撞告警紧急程度（3级），以及相应的避碰决策建议。
   紧急程度说明：
    紧急：保证最低限度的从当前速度到完全停止，预留 5s（可调）；
          碰撞距离小于速度x 5（举例3m/s x 5s=15m）
    警告：保证最低限度的从当前速度到完全停止，预留 30s（可调）；
          碰撞距离小于速度x 30（举例 5m/s x 30s=150m）
    正常：从紧急或警告恢复，即不在危险区域，大于30s；
          碰撞距离大于速度 x 30。 

2.	碰撞告警船ID。
    当前船 id，
    前向被碰撞船 id。若存在多个时，仅上报距离最近船 id，
    对向被碰撞船 id。若存在多个时，需要上报所有船 id。
 
3.	预计发生碰撞的位置：经纬度（WGS84）
 
4. 预计发生碰撞的时间：秒
   
5.	对向碰撞告警时两船的实际航向（Headinㅤ）：单位与输入保持一致，度，0 为正北。
五. 甲方提供给的数据类型和格式
（一）. 统一格式：采用 JSON 格式为主，便于接口交换与日志存储。
（二）. 统一单位：时间为秒（s），坐标为 WGS84经纬度，速度为米/秒（m/s），角度为度（°）。
（三）. 数据格式可扩展性强：所有结构均可扩展其他字段。
（四）. 数据格式样例如下：
无人船动态数据（BoatState）：
{
  "sysid": 1,
  "timestamp": 1722325256.530,   // 接收时间戳（UTC或本机时间，单位：秒）
  "lat": 30.549832,              // 纬度（WGS84）
  "lng": 114.342922,            // 经度（WGS84）
  "heading": 90.0,              // 航向角（0°为正北，顺时针增加）
  "speed": 2.5,                 // 船速，单位：米/秒
  "status": 2,                  // 航行状态（1-出坞，2-正常航行，3-入坞）
  "route_direction": 1           // 航线方向（1-顺时针，2-逆时针）
}
船坞静态数据（DockInfo）：
{
  "dock_id": 1,
  "lat": 30.549100,
  "lng": 114.343000
}
航线定义数据（RouteInfo）：
{
  "route_id": 1,
  "direction": 1,                // 1-顺时针，2-逆时针
  "points": [
    {"lat": 30.549500, "lng": 114.342800},
    {"lat": 30.549800, "lng": 114.343300},
    {"lat": 30.550100, "lng": 114.343800}
  ]
}
系统配置文件：
{
  "boat": {
    "length": 0.75,              // 单位：米
    "width": 0.47
  },
  "emergency_threshold_s": 5,     // 紧急判断时间阈值（秒）
  "warning_threshold_s": 30,      // 警告判断时间阈值（秒）
  "max_boats": 30,
  "min_route_gap_m": 10         // 最小航线横向间距
}
